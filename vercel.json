{
    "version": 2,
    "builds": [
        {
            "src": "backend/server.js",
            "use": "@vercel/node",
            "config": {
                "nodeVersion": "18.x",
                "includeFiles": [
                    "backend/routes/**/*.js",
                    "backend/data/**/*",
                    "backend/services/**/*",
                    "data/**/*",
                    ".env"
                ]
            }
        },
        {
            "src": "project/**/*.html",
            "use": "@vercel/static"
        },
        {
            "src": "admin/**/*.html",
            "use": "@vercel/static"
        }
    ],
    "routes": [
        {
            "src": "/api/(.*)",
            "dest": "/backend/server.js",
            "headers": {
                "Access-Control-Allow-Origin": "*",
                "Access-Control-Allow-Methods": "GET,POST,PUT,DELETE,OPTIONS",
                "Access-Control-Allow-Headers": "X-Requested-With, Content-Type, Authorization"
            }
        },
        {
            "src": "/",
            "dest": "/project/index.html"
        },
        {
            "src": "/about",
            "dest": "/project/about.html"
        },
        {
            "src": "/contact",
            "dest": "/project/contact.html"
        },
        {
            "src": "/estimate",
            "dest": "/project/estimate.html"
        },
        {
            "src": "/admin/login",
            "dest": "/admin/login.html"
        },
        {
            "src": "/admin/submissions",
            "dest": "/admin/submissions.html"
        },
        {
            "src": "/admin/settings",
            "dest": "/admin/admin-settings.html"
        },
        {
            "src": "/admin/contacts",
            "dest": "/admin/contacts.html"
        },
        {
            "src": "/admin/estimates",
            "dest": "/admin/estimates.html"
        },
        {
            "src": "/css/(.*)",
            "dest": "/project/css/$1",
            "headers": {
                "Cache-Control": "public, max-age=31536000, immutable"
            }
        },
        {
            "src": "/js/(.*)",
            "dest": "/project/js/$1",
            "headers": {
                "Cache-Control": "public, max-age=31536000, immutable"
            }
        },
        {
            "src": "/images/(.*)",
            "dest": "/project/images/$1",
            "headers": {
                "Cache-Control": "public, max-age=31536000, immutable"
            }
        },
        {
            "src": "/(es|zh)/?",
            "dest": "/project/index.html?lang=$1"
        },
        {
            "src": "/(es|zh)/about",
            "dest": "/project/about.html?lang=$1"
        },
        {
            "src": "/(es|zh)/contact",
            "dest": "/project/contact.html?lang=$1"
        },
        {
            "src": "/(es|zh)/estimate",
            "dest": "/project/estimate.html?lang=$1"
        },
        {
            "src": "/(.*)",
            "status": 404,
            "dest": "/project/404.html"
        }
    ],
    "rewrites": [
        {
            "source": "/(.*)",
            "destination": "/project/$1"
        }
    ],
    "github": {
        "silent": true,
        "autoJobCancelation": true
    },
    "headers": [
        {
            "source": "/(.*)",
            "headers": [
                {
                    "key": "X-Frame-Options",
                    "value": "SAMEORIGIN"
                },
                {
                    "key": "X-Content-Type-Options",
                    "value": "nosniff"
                },
                {
                    "key": "Referrer-Policy",
                    "value": "strict-origin-when-cross-origin"
                }
            ]
        }
    ]
}